show databases;
use bizffice
show tables;
use bizffice;
show tables;
select * from user;
select count(*) from realContract where user_id=00000011 and r_g_in_building_id=319 and (getStatus(startDate, endDate2)='present' or getStatus(startDate, endDate2)='waiting');
show bizffice;
show tablse;
use bizffice
show tables;
drop database bizffice;
show databases;
create database bizffice
;
show databases;
use bizffice
show tables;
delimiter $$
 CREATE DEFINER=`leaseman`@`127.0.0.1` FUNCTION `getdiv`(pExpectedDate char(10), executiveDate char(10)) RETURNS varchar(20) CHARSET utf8
    DETERMINISTIC
BEGIN  declare result varchar(20);  IF date(executiveDate) THEN    IF date(executiveDate)  <= date(pExpectedDate)  THEN     SET result = 'geted';    ELSE SET result = 'get_delay';    END IF; ELSE    IF curdate() <= date(pExpectedDate)  THEN     SET result = 'not_get';    ELSE       SET result = 'not_get_delay';    END IF; END IF;  RETURN result;  END
$$
CREATE DEFINER=`leaseman`@`127.0.0.1` FUNCTION `getdiv`(pExpectedDate char(10), executiveDate char(10)) RETURNS varchar(20) CHARSET utf8     DETERMINISTIC BEGIN  declare result varchar(20);  IF date(executiveDate) THEN    IF date(executiveDate)  <= date(pExpectedDate)  THEN     SET result = 'geted';    ELSE SET result = 'get_delay';    END IF; ELSE    IF curdate() <= date(pExpectedDate)  THEN     SET result = 'not_get';    ELSE       SET result = 'not_get_delay';    END IF; END IF;  RETURN result;  END$$
create FUNCTION `getdiv`(pExpectedDate char(10), executiveDate char(10)) RETURNS varchar(20) CHARSET utf8
DETERMINISTIC
BEGIN  declare result varchar(20);  IF date(executiveDate) THEN    IF date(executiveDate)  <= date(pExpectedDate)  THEN     SET result = 'geted';    ELSE SET result = 'get_delay';    END IF; ELSE    IF curdate() <= date(pExpectedDate)  THEN     SET result = 'not_get';    ELSE       SET result = 'not_get_delay';    END IF; END IF;  RETURN result;  END
$$
create FUNCTION `getdiv`(pExpectedDate char(10), executiveDate char(10)) RETURNS varchar(20) CHARSET utf8 DETERMINISTIC BEGIN  declare result varchar(20);  IF date(executiveDate) THEN    IF date(executiveDate)  <= date(pExpectedDate)  THEN     SET result = 'geted';    ELSE SET result = 'get_delay';    END IF; ELSE    IF curdate() <= date(pExpectedDate)  THEN     SET result = 'not_get';    ELSE       SET result = 'not_get_delay';    END IF; END IF;  RETURN result;  END$$
show function status
;
$
$$;
show function status ; $$$
$
$$
; $$$
;
$$
create FUNCTION `getStatus`(startdate char(10), enddate char(10)) RETURNS varchar(20) CHARSET utf8
    DETERMINISTIC
BEGIN
declare result varchar(20);
IF curdate() < date(startdate) THEN
    SET result = 'waiting';
   
ELSEIF curdate() >= date(startdate) THEN
    IF curdate() <= date(enddate) THEN
    SET result = 'present';
   
    ELSEIF curdate() > date(enddate) THEN
    SET result = 'the_end';
   
    end if;
end if;
RETURN result;
END $$
create FUNCTION `getStatus`(startdate char(10), enddate char(10)) RETURNS varchar(20) CHARSET utf8     DETERMINISTIC BEGIN  declare result varchar(20);  IF curdate() < date(startdate) THEN     SET result = 'waiting';     ELSEIF curdate() >= date(startdate) THEN      IF curdate() <= date(enddate) THEN     SET result = 'present';         ELSEIF curdate() > date(enddate) THEN     SET result = 'the_end';         end if;  end if;  RETURN result; END$$
delimiter ;
show function status;
select count(*) from realContract where user_id=00000011 and r_g_in_building_id=319 and (getStatus(startDate, endDate2)='present' or getStatus(startDate, endDate2)='waiting');
delimiter $$
create FUNCTION `status2`(startdate char(10), enddate char(10), enddate3 char(10)) RETURNS char(20) CHARSET utf8
    DETERMINISTIC
BEGIN declare result varchar(20); IF date(enddate3) THEN set result = 'middle_end'; ELSEIF curdate() < date(startdate) THEN set result = 'waiting'; ELSEIF curdate() >= date(startdate) THEN   IF curdate() <= date(enddate) THEN set result = 'present';   ELSEIF curdate() > date(enddate) THEN set result = 'the_end';   end if; end if; return result; END $$
create FUNCTION `status2`(startdate char(10), enddate char(10), enddate3 char(10)) RETURNS char(20) CHARSET utf8     DETERMINISTIC BEGIN declare result varchar(20); IF date(enddate3) THEN set result = 'middle_end'; ELSEIF curdate() < date(startdate) THEN set result = 'waiting'; ELSEIF curdate() >= date(startdate) THEN   IF curdate() <= date(enddate) THEN set result = 'present';   ELSEIF curdate() > date(enddate) THEN set result = 'the_end';   end if; end if; return result; END$$
delimiter ;
use bizffice
select
      etcContract.id as eid,
      customer.id as cid,
      customer.name as cname,
      customer.companyname,
      customer.div2,
      customer.div3,
      customer.contact1,
      customer.contact2,
      customer.contact3,
      building.bName as bname,
      good_in_building.name as goodname,
      paySchedule2.executiveDate,
      paySchedule2.pAmount,
      paySchedule2.pvAmount,
      paySchedule2.ptAmount,
      paySchedule2.payKind,
      etcContract.etc as eetc
  from
      etcContract
  left join customer
      on etcContract.customer_id = customer.id
  left join paySchedule2
      on etcContract.paySchedule2_id = paySchedule2.idpayschedule2
  left join building
      on etcContract.building_id = building.id
  left join good_in_building
      on etcContract.good_in_building_id = good_in_building.id
  where etcContract.user_id = 00000011 and
        
           and (DATE(executiveDate) BETWEEN '2021-10-1' and '2021-10-31')
  order by
      paySchedule2.executiveDate;
select       etcContract.id as eid,       customer.id as cid,       customer.name as cname,       customer.companyname,       customer.div2,       customer.div3,       customer.contact1,       customer.contact2,       customer.contact3,       building.bName as bname,       good_in_building.name as goodname,       paySchedule2.executiveDate,       paySchedule2.pAmount,       paySchedule2.pvAmount,       paySchedule2.ptAmount,       paySchedule2.payKind,       etcContract.etc as eetc   from       etcContract   left join customer       on etcContract.customer_id = customer.id   left join paySchedule2       on etcContract.paySchedule2_id = paySchedule2.idpayschedule2   left join building       on etcContract.building_id = building.id   left join good_in_building       on etcContract.good_in_building_id = good_in_building.id   where etcContract.user_id = 00000011 and                     and (DATE(executiveDate) BETWEEN '2021-10-1' and '2021-10-31')   order by       paySchedule2.executiveDate;
desc customer;
